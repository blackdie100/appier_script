import requests
from datetime import datetime,timedelta

NowTime = datetime.now() + timedelta(seconds=28800)
NowTimestamp = datetime.timestamp(NowTime)

MemberWarning_StartTime = NowTime + timedelta(seconds=14400)
MemberWarning_EndTime = NowTime + timedelta(seconds=100500)
MemberWarning_StartTimestamp = datetime.timestamp(MemberWarning_StartTime)
MemberWarning_EndTimestamp = datetime.timestamp(MemberWarning_EndTime)

Active = '11' ## 0 is inactive, 11 is active

MemberWarning_url = "https://aiqua.appier.com/qganalyzedata/v2/campaigns/1611239/"
# MemberWarning_payload = '{\n    \"active\": \"%s\",\n    \"id\": 1298341,\n    \"type1\": \"inweb\",\n    \"name\": \"【全站】周三與周日會員日提醒\",\n    \"description\": \"\",\n    \"channel\": \"push\",\n    \"type\": \"web\",\n    \"include_segments\": [\n        130638\n    ],\n    \"exclude_segments\": [],\n    \"segment\": 130638,\n    \"includesegment\": null,\n    \"excludesegment\": null,\n    \"creative\": {\n        \"type\": \"inweb\",\n        \"triggerType\": \"userEvent\",\n        \"startTime\": %d,\n        \"endTime\": %d,\n        \"include_new_users\": true,\n        \"whenCond\": {\n            \"eventName\": \"page_viewed\",\n            \"operator\": \"AND\",\n            \"conditions\": []\n        },\n        \"scheduledType\": \"once\",\n        \"maxNumTimesToShow\": 1,\n        \"audiencePlatform\": {\n            \"android\": true,\n            \"ios\": true,\n            \"others\": true\n        },\n        \"abCreativeVariants\": [\n            {\n                \"creativeType\": \"multipleActions\",\n                \"variantName\": \"實驗組別 1\",\n                \"maxLeadSubmitCount\": 1,\n                \"multipleActions\": {\n                    \"showOverlay\": true,\n                    \"location\": \"middle-center\",\n                    \"popupWidth\": 320,\n                    \"popupHeight\": 530,\n                    \"marginTop\": 0,\n                    \"marginRight\": 0,\n                    \"marginBottom\": 0,\n                    \"marginLeft\": 0,\n                    \"popupBackgroundColor\": \"#fff\",\n                    \"hasImage\": true,\n                    \"imageRatio\": \"1:1\",\n                    \"imgSrc\": \"https://dv3x0n09cblid.cloudfront.net/Files/activity/151/image/UNI_135100394.jpg\",\n                    \"imageFit\": \"cover\",\n                    \"title\": \"【就是今天】週三/週日會員日紅利點數雙倍送\",\n                    \"titleColor\": \"rgba(65, 117, 5, 1)\",\n                    \"message\": \"【今天買, 最划算! 】安永鮮物-防疫健康好食材, Easy-to-Cook! Ready-to-Eat! 美味輕鬆上桌, 居家防疫最簡單!\",\n                    \"messageColor\": \"rgba(74, 74, 74, 1)\",\n                    \"hasCallToAction\": true,\n                    \"closeButtonBackgroundSize\": 24,\n                    \"closeButtonBackgroundColor\": \"#fff\",\n                    \"closeButtonIconSize\": 12,\n                    \"closeButtonIconColor\": \"#000\",\n                    \"callToActions\": [\n                        {\n                            \"callToActionText\": \"馬上雙倍送! GO\",\n                            \"callToActionTextColor\": \"#fff\",\n                            \"fontWeight\": 400,\n                            \"callToActionMethod\": \"openUrl\",\n                            \"redirectUrl\": \"https://bit.ly/3eu1SOD\",\n                            \"callToActionClass\": \"primary\",\n                            \"callToActionBackgroundColor\": \"rgba(184, 179, 49, 1)\",\n                            \"borderRadius\": 20,\n                            \"isTargetBlank\": true\n                        }\n                    ]\n                }\n            }\n        ],\n        \"isAB\": false\n    },\n    \"priority\": 2,\n    \"event\": \"nothing\",\n    \"trigger\": \"nothing\",\n    \"stats\": {\n        \"last_refresh_start_datetime\": \"2021-07-18 19:43:09\",\n        \"total_seg_duration\": 0,\n        \"pid\": \"30750\",\n        \"detailedLog\": \"http://internal.aiqua.appier.info/log/crunner-inweb/toggle/detailed-log/2021-07-18/20210718-160857-1298341-2499-30750.txt\",\n        \"total_records\": 2,\n        \"logFilePath\": \"http://internal.aiqua.appier.info/log/crunner-inweb/toggle/log/2021-07-18/20210718-160857-1298341-2499-30750.txt\",\n        \"last_refresh_end_datetime\": \"2021-07-18 19:43:11\",\n        \"campaign_start_time\": \"2021-07-18 16:08:57\"\n    },\n    \"account\": \"2499\"\n}' % (Active, int(MemberWarning_StartTimestamp), int(MemberWarning_EndTimestamp)) 
# MemberWarning_payload = '{\n    \"active\": \"%s\",\n    \"id\": 1298341,\n    \"type1\": \"inweb\",\n    \"name\": \"【全站】周三與周日會員日提醒\",\n    \"description\": \"\",\n    \"channel\": \"push\",\n    \"type\": \"web\",\n    \"include_segments\": [\n        130638\n    ],\n    \"exclude_segments\": [],\n    \"segment\": 130638,\n    \"includesegment\": null,\n    \"excludesegment\": null,\n    \"creative\": {\n        \"type\": \"inweb\",\n        \"triggerType\": \"userEvent\",\n        \"startTime\": %d,\n        \"endTime\": %d,\n        \"include_new_users\": true,\n        \"allow_coexisted\": false,\n        \"whenCond\": {\n            \"eventName\": \"page_viewed\",\n            \"operator\": \"AND\",\n            \"conditions\": []\n        },\n        \"scheduledType\": \"once\",\n        \"maxNumTimesToShow\": 1,\n        \"audiencePlatform\": {\n            \"android\": true,\n            \"ios\": true,\n            \"others\": true\n        },\n        \"abCreativeVariants\": [\n            {\n                \"creativeType\": \"multipleActions\",\n                \"variantName\": \"實驗組別 1\",\n                \"maxLeadSubmitCount\": 1,\n                \"multipleActions\": {\n                    \"showOverlay\": true,\n                    \"location\": \"middle-center\",\n                    \"popupWidth\": 320,\n                    \"popupHeight\": 530,\n                    \"marginTop\": 0,\n                    \"marginRight\": 0,\n                    \"marginBottom\": 0,\n                    \"marginLeft\": 0,\n                    \"popupBackgroundColor\": \"#fff\",\n                    \"hasImage\": true,\n                    \"imageRatio\": \"1:1\",\n                    \"imgSrc\": \"https://dv3x0n09cblid.cloudfront.net/Files/activity/151/image/UNI_135100394.jpg\",\n                    \"imageFit\": \"cover\",\n                    \"title\": \"【就是今天】週三/週日會員日紅利點數雙倍送\",\n                    \"titleColor\": \"rgba(65, 117, 5, 1)\",\n                    \"message\": \"【今天買, 最划算! 】安永鮮物-防疫健康好食材, Easy-to-Cook! Ready-to-Eat! 美味輕鬆上桌, 居家防疫最簡單!\",\n                    \"messageColor\": \"rgba(74, 74, 74, 1)\",\n                    \"hasCallToAction\": true,\n                    \"closeButtonBackgroundSize\": 24,\n                    \"closeButtonBackgroundColor\": \"#fff\",\n                    \"closeButtonIconSize\": 12,\n                    \"closeButtonIconColor\": \"#000\",\n                    \"callToActions\": [\n                        {\n                            \"callToActionText\": \"馬上雙倍送! GO\",\n                            \"callToActionTextColor\": \"#fff\",\n                            \"fontWeight\": 400,\n                            \"callToActionMethod\": \"openUrl\",\n                            \"redirectUrl\": \"https://bit.ly/3eu1SOD\",\n                            \"callToActionClass\": \"primary\",\n                            \"callToActionBackgroundColor\": \"rgba(184, 179, 49, 1)\",\n                            \"borderRadius\": 20,\n                            \"isTargetBlank\": true\n                        }\n                    ]\n                }\n            }\n        ],\n        \"isAB\": false\n    },\n    \"priority\": 2,\n    \"event\": \"nothing\",\n    \"trigger\": \"nothing\",\n    \"stats\": {\n        \"last_refresh_start_datetime\": \"2021-12-04 18:41:54\",\n        \"total_seg_duration\": 0,\n        \"pid\": \"27343\",\n        \"detailedLog\": \"http://internal.aiqua.appier.info/log/crunner-inweb/toggle/detailed-log/2021-12-07/20211207-040002-1298341-2499-27343.txt\",\n        \"total_records\": 2,\n        \"logFilePath\": \"http://internal.aiqua.appier.info/log/crunner-inweb/toggle/log/2021-12-07/20211207-040002-1298341-2499-27343.txt\",\n        \"last_refresh_end_datetime\": \"2021-12-04 18:41:54\",\n        \"campaign_start_time\": \"2021-12-07 04:00:02\"\n    },\n    \"account\": \"2499\"\n}' % (Active, int(MemberWarning_StartTimestamp), int(MemberWarning_EndTimestamp))
MemberWarning_payload = "{\n    \"active\": \"%s\",\n    \"id\": 1611239,\n    \"type1\": \"inweb\",\n    \"name\": \"【全站】週三與週日會員日提醒\",\n    \"description\": \"\",\n    \"channel\": \"push\",\n    \"type\": \"web\",\n    \"include_segments\": [\n        291449\n    ],\n    \"exclude_segments\": [],\n    \"segment\": 291449,\n    \"includesegment\": null,\n    \"excludesegment\": null,\n    \"creative\": {\n        \"type\": \"inweb\",\n        \"triggerType\": \"userEvent\",\n        \"startTime\": %d,\n        \"endTime\": %d,\n        \"include_new_users\": true,\n        \"allow_coexisted\": false,\n        \"whenCond\": {\n            \"eventName\": \"page_viewed\",\n            \"operator\": \"AND\",\n            \"conditions\": []\n        },\n        \"scheduledType\": \"once\",\n        \"maxNumTimesToShow\": 1,\n        \"audiencePlatform\": {\n            \"android\": true,\n            \"ios\": true,\n            \"others\": true\n        },\n        \"abCreativeVariants\": [\n            {\n                \"creativeType\": \"multipleActions\",\n                \"variantName\": \"實驗組 1\",\n                \"maxLeadSubmitCount\": 1,\n                \"multipleActions\": {\n                    \"showOverlay\": true,\n                    \"location\": \"middle-center\",\n                    \"popupWidth\": 320,\n                    \"popupHeight\": 530,\n                    \"marginTop\": 0,\n                    \"marginRight\": 0,\n                    \"marginBottom\": 0,\n                    \"marginLeft\": 0,\n                    \"popupBackgroundColor\": \"#fff\",\n                    \"hasImage\": true,\n                    \"imageRatio\": \"1:1\",\n                    \"imgSrc\": \"https://dv3x0n09cblid.cloudfront.net/Files/activity/151/image/UNI_135100394.jpg\",\n                    \"imageFit\": \"cover\",\n                    \"title\": \"【就是今天】週三/週日會員日紅利點數雙倍送\",\n                    \"titleColor\": \"rgba(184, 179, 49, 1)\",\n                    \"message\": \"【今天買, 最划算! 】安永鮮物-防疫健康好食材, Easy-to-Cook! Ready-to-Eat! 美味輕鬆上桌, 居家防疫最簡單!\",\n                    \"messageColor\": \"#000\",\n                    \"hasCallToAction\": true,\n                    \"closeButtonBackgroundSize\": 24,\n                    \"closeButtonBackgroundColor\": \"#fff\",\n                    \"closeButtonIconSize\": 12,\n                    \"closeButtonIconColor\": \"#000\",\n                    \"callToActions\": [\n                        {\n                            \"callToActionText\": \"馬上雙倍送! GO\",\n                            \"callToActionTextColor\": \"#fff\",\n                            \"fontWeight\": 400,\n                            \"callToActionMethod\": \"openUrl\",\n                            \"redirectUrl\": \"https://www.anyongfresh.com/\",\n                            \"callToActionClass\": \"primary\",\n                            \"callToActionBackgroundColor\": \"rgba(184, 179, 49, 1)\",\n                            \"borderRadius\": 20,\n                            \"isTargetBlank\": true\n                        }\n                    ]\n                }\n            }\n        ],\n        \"isAB\": false\n    },\n    \"priority\": 1,\n    \"event\": \"nothing\",\n    \"trigger\": \"nothing\",\n    \"stats\": {\n        \"last_refresh_start_datetime\": \"2023-03-28 19:40:39\",\n        \"total_seg_duration\": 0,\n        \"pid\": \"22735\",\n        \"detailedLog\": \"https://dashboard.k8s.aiqua.appier.info//log/crunner-inweb/toggle/detailed-log/2023-04-28/20230428-041409-1611239-2831-22735.txt\",\n        \"total_records\": 2,\n        \"logFilePath\": \"https://dashboard.k8s.aiqua.appier.info//log/crunner-inweb/toggle/log/2023-04-28/20230428-041409-1611239-2831-22735.txt\",\n        \"last_refresh_end_datetime\": \"2023-03-28 19:40:40\",\n        \"campaign_start_time\": \"2023-04-28 04:14:09\"\n    },\n    \"account\": \"2831\"\n}" % (Active, int(MemberWarning_StartTimestamp), int(MemberWarning_EndTimestamp))

headers = {
  # Old Id
  # 'Authorization': 'Token 4a1526adf51b0a9054a563a13f20d534d06854f5',
  # 'appId': '2eac7f0b7cd0bb7519d3',

  # New Id
  'Authorization': 'Token 03a909b88e3f3bd63e57e8d3b2fa8676cb7780ee',
  'appId': '087f314577ef660f5a6e',

  'Content-Type': 'application/json'
}

MemberWarning_response = requests.request("PUT", MemberWarning_url, headers=headers, data = MemberWarning_payload.encode('utf-8'))

print(MemberWarning_response.text.encode('utf8'))